
\chapter{Conclusiones y líneas futuras}
\label{cha:concl-lineas-futuras}

\begin{FraseCelebre}
  \begin{Frase}
    El trabajo ocupará una gran parte de tu vida, la mejor forma de lidiar con ello, es encontrar algo que realmente ames.
  \end{Frase}
  \begin{Fuente}
    Steve Jobs
  \end{Fuente}
\end{FraseCelebre}

En este apartado se resumen las conclusiones obtenidas y se proponen futuras líneas de investigación
que se deriven del trabajo.

\section{Conclusiones}
\label{sec:conclusiones-finales}

Este proyecto se ha enfocado en el desarrollo de una estrategia para la detección de objetos abandonados en sistemas de videovigilancia. Para ello, se realizado un estudio del Estado del Arte sobre las distintas metodologías en la detección de objetos abandonados. Las técnicas que se llevaban utilizando en los últimos años son las de segmentación de objetos en movimiento en primer plano, detección de objetos estacionarios, reconocimiento de comportamientos y detección de personas y objetos.

Se ha decidido utilizar \gls{cnn} como estrategia en la detección de personas y objetos, ya que se pueden desarrollar sistemas de detección en tiempo real. Tras evaluar las métricas de los distintos algoritmos de detección de objetos se ha escogido \gls{yolov4} ya que, respecto a sus principales competidores, \gls{ssd}, EfficientDet o Faster \gls{r-cnn}, presenta una mayor relación de \gls{map} y \gls{fps} en los benchmarks del dataset de \gls{coco}.

Se ha entrenado dos redes neuronales para que solo detectase las clases de interés: personas, mochilas, bolsos, bolsas de mano y maletas. Se ha empleado el dataset de \gls{oidv4} para el entrenamiento de la red, tomando 1.500 imágenes de cada clase para el entrenamiento y 300 de cada clase para la validación (un 20 \% de las imágenes respecto a las del entrenamiento). Es aconsejable realizar un entrenamiento con 2.000 iteraciones por cada clase entrenada, por tanto, teniendo 4 clases, se fijó las iteraciones máximas a 8.000. En el primer entrenamiento salieron valores de \gls{map} aceptables, sin embargo, como se observa en la tabla \ref{tab:metricas-test1_4}, aparecieron muchos más \gls{fp} que \gls{tp} lo que derivó a obtener valores de \gls{iou} muy bajos, inferiores al 50 \%. En el segundo entrenamiento de la red neuronal se propuso aumentar el número de clases. A diferencia de \gls{coco}, que solo dispone de 80 clases muy generalizadas, el dataset \gls{oidv4} ofrece clases más específicas, como modelos concretos de maletas o de bolsas de mano, que resultan interesantes para el entrenamiento de nuestra red. Se emplearon 7 clases y se subió las máximas iteraciones a 20.000, por no limitar el entrenamiento a lo mínimo recomendable. Los valores de las métricas de calidad obtenidas fueron muy similares a los del primer entrenamiento. En vista a los resultados de los dos entrenamientos, se decidió continuar el proyecto con el dataset de referencia \gls{coco}, ya que las métricas de calidad de los dos entrenamientos realizados fueron muy inferiores.

Se han estudiado los métodos de \gls{mot} mas recientes, \gls{sort} y \gls{deepsort}. Se ha comprobado que utilizando el algoritmo de seguimiento \gls{deepsort}, el cual trabaja excelentemente con \gls{yolov4}, se obtuvieron buenos resultados en el rastreo de personas y objetos de interés. Se produjeron problemas en el seguimiento en secuencias de vídeo donde hay grandes aglomeraciones de personas que se cruzan, se encuentran superpuestas produciendo oclusiones o desaparecen del plano durante varios segundos, lo cual origina que se pierda el seguimiento de la identidad, obligando a crear una nueva identidad y asociación entre persona y objeto.

Se ha diseñado un algoritmo capaz de detectar objetos abandonados. Se han expuesto dos posibles escenarios. El primer escenario es que el objeto permanezca inmóvil en el mismo punto durante toda la secuencia de vídeo y no tenga ninguna persona asociada como propietaria. En tal caso cuando han transcurrido 15 segundos, se indica que ese objeto se encuentra perdido o ha sido abandonado. El segundo escenario se ha tenido que lidiar con el problema de la asociación persona-objeto. Para ello, se ha calculado la distancia de los centroides de los cuadros delimitadores entre las personas y todos los objetos detectables, estableciendo una asociación persona-objeto cuando se detectase la mínima en píxeles. Una vez creada, la asociación se ha podido comprobar que el algoritmo diseñado detecta cuando un objeto se aleja de su propietario una distancia equivalente a 5 veces la distancia medida cuando se genera la asociación.

Finalmente se ha validado el funcionamiento de los algoritmos con los datasets más utilizados en la evaluación de sistemas de detección de objetos abandonados, como son \gls{pets}, \gls{aboda}, \gls{avss} o \gls{gba2018}. Se han escogido secuencias de vídeo diferenciadas donde ocurren cambios de iluminación, objetos cercanos o alejados o distintas resoluciones de vídeo.

No se obtuvieron buenos resultados cuando el objeto que había sido abandonado se encontraba totalmente tumbado en el suelo. Ocurrían dos sucesos, el primero es que la detección cambiase cada poco segundos y se perdiera tanto la identidad del objeto como la asociación persona-objeto. El segundo suceso es que la predicción bajara del 25 \% y se dejara tanto de detectar como de rastrear. Esto se puede deber a que \gls{coco} no contiene las suficientes imágenes de bolsos, mochilas, bolsas de mano y maletas desde ángulos desfavorable, por tanto se pierde precisión en la detección.

En las secuencias de vídeo donde se evaluaba el abandono de maletas o bolsas que no perdían su forma al posarlas en el suelo, se obtuvieron buenos resultados con tasas bajas de fallos en la detección de objeto abandonado.

\section{Líneas futuras}
\label{sec:lineas-futuras}

A continuación, se van plantear posibles líneas futuras para mejorar la estrategia planteada en este proyecto, así como trabajos que pueden ser desarrollados utilizando el presente como base: 

\begin{itemize}
    \item \textbf{Utilizar Scaled-YOLOv4}. En \cite{bochkovskiy2020yolov4} se demostró que la red neuronal de detección \gls{yolov4} escala tanto hacia arriba como hacia abajo y es aplicable a redes tanto grandes como pequeñas manteniendo una alta precisión y velocidad. En diciembre de 2020 se propuso en \cite{wang2021scaledyolov4} un enfoque de escalamiento de la red que modifica la profundidad, ancho, resolución y estructura de la red neuronal obteniéndose una mAP del 73,4 \% sobre el dataset de \gls{coco} a una velocidad de 16 \gls{fps} con una NVIDIA Tesla V100. Se trata de la mayor precisión sobre el dataset de \gls{coco} que se conoce en todos los trabajos publicados. Esto permite mejorar las detecciones y en consecuencia un mayor seguimiento sobre las personas y los objetos con lo que podría solucionar los problemas de pérdidas de asociación persona-objeto producidos en las evaluaciones de datasets más complejos.
    \item \textbf{Diseño de un algoritmo de detección de objetos abandonados basado en \gls{fairmot}}. Dos puntos clave en la reidentificación de objetos es la detección y seguimiento. Ningún trabajo publicado ha propuesto una solución que se realice estas dos tareas dentro de una misma red. Al depender el seguimiento de las detecciones hace que se pierda precisión y cause pérdidas de identidad. En \cite{zhang2020fair} se propone una red neuronal capaz de detectar y reidentificar objetos de manera simultánea y obteniendo una alta puntuación en el benchmark dataset MOT16 \cite{milan2016mot16}.
    \item \textbf{Diferenciar cuando un objeto ha sido abandonado o robado}. Durante todo el proyecto se ha trabajo el desarrollo de un algoritmo capaz de detectar cuando un objeto ha sido abandonado. No se ha contemplado la posibilidad de que el objeto haya podido ser robado. En \cite{9079525} se propone una estrategia para diferenciar cuando un objeto ha sido abandonado y cuando ha sido robado. Sería interesante tener ese trabajo como referencia para poder tener en cuenta esa variable en la detección de objetos en los sistemas de videovigilancia.
    \item \textbf{Entrenar red neuronal con otros datasets}. En el presente proyecto se han entrenado dos modelos de \gls{yolov4} basados en el dataset \gls{oidv4} obteniéndose malos resultados. Finalmente se propuso continuar con el modelo preentrenado de \gls{yolov4} en \gls{coco}. Sería interesante probar otros datasets como el de ImageNet \cite{russakovsky2015imagenet} o crear un dataset propio para contemplar la posibilidad de mejorar las métricas de calidad.
    \item \textbf{Implementación en tarjetas NVIDIA Jetson}. Durante la realización de este \gls{tfm} se han evaluado los algoritmos sobre equipos con especificaciones altas o mediante el uso de Google Colab, donde se emplean las \gls{gpu}'s NVIDIA Tesla K80, P4, T4 y P100. De cara a comercializar un servicio que ofrezca la detección de objetos abandonados y se descarte un servicio en la nube sería interesante comprobar si, utilizando tarjetas de baja potencia como pueden ser las NVIDIA Jetson Xavier NX o Jetson AGX Xavier, que vienen con \gls{cuda} instalado de fábrica, se puede utilizar durante largos tiempos en sistemas de videovigilancia.
    \item \textbf{Distanciamiento social}. A partir de este trabajo se puede plantear una estrategia de detección y seguimiento en el distanciamiento social. En los últimos meses está creciendo las demandas de sistemas de seguridad que incluyan el control de distancia social en aforos debido al COVID-19. En el presente proyecto se plantea una estrategia donde se emplea un algoritmo de detección junto a un algoritmo de seguimiento que puede ser utilizado como base para desarrollar una red neuronal capaz de detectar si se está cumpliendo el distanciamiento social social o no. En \cite{punn2020monitoring}, \cite{Rezaei_2020}, \cite{Gupta_2020} y \cite{fan2020autonomous} se están empleando \gls{cnn} con \gls{yolo} y \gls{deepsort} para abordar este problema.
    
\end{itemize}